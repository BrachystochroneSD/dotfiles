#!/bin/bash

# This simple script count all the file of each "new" folder of my mail folder (offlineimap dependency (or equivalent Maildir shit)).


count_mail(){
    num_mail=$(find ~/mail new 2>/dev/null | grep -c new/)
    [[ ! $num_mail == 0 ]] && echo " $num_mail" || echo ""
}

update_mail(){
if ping -q -c 1 -W 1 1.1.1.1 &>/dev/null; then
    offlineimap -u quiet >/dev/null
fi
}


while true; do
    update_mail
    for i in {1..60}; do
	count_mail
	sleep 1
    done
done
